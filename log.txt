2020-02-01 15:45:04.298461: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-02-01 15:45:04.800350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:02:00.0
totalMemory: 10.91GiB freeMemory: 10.75GiB
2020-02-01 15:45:04.800429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2020-02-01 15:45:05.180609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-02-01 15:45:05.180674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2020-02-01 15:45:05.180686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2020-02-01 15:45:05.181008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10396 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)
Epoch 1/1000
 - 251s - loss: 0.0116 - psnr: 86.2343 - ssim: 0.9907
Using TensorFlow backend.

Epoch 00001: loss improved from inf to 0.01165, saving model to ./ckpt/ckpt.mdl
Epoch 2/1000
Traceback (most recent call last):
  File "Train.py", line 72, in <module>
    main()
  File "Train.py", line 62, in main
    history = train(model)
  File "Train.py", line 45, in train
    callbacks=[checkpoint,tensorboard])
  File "/home/ruianhe/miniconda3/envs/tensorflow/lib/python3.6/site-packages/keras/legacy/interfaces.py", line 91, in wrapper
    return func(*args, **kwargs)
  File "/home/ruianhe/miniconda3/envs/tensorflow/lib/python3.6/site-packages/keras/engine/training.py", line 1418, in fit_generator
    initial_epoch=initial_epoch)
  File "/home/ruianhe/miniconda3/envs/tensorflow/lib/python3.6/site-packages/keras/engine/training_generator.py", line 217, in fit_generator
    class_weight=class_weight)
  File "/home/ruianhe/miniconda3/envs/tensorflow/lib/python3.6/site-packages/keras/engine/training.py", line 1211, in train_on_batch
    class_weight=class_weight)
  File "/home/ruianhe/miniconda3/envs/tensorflow/lib/python3.6/site-packages/keras/engine/training.py", line 751, in _standardize_user_data
    exception_prefix='input')
  File "/home/ruianhe/miniconda3/envs/tensorflow/lib/python3.6/site-packages/keras/engine/training_utils.py", line 128, in standardize_input_data
    'with shape ' + str(data_shape))
ValueError: Error when checking input: expected input to have 4 dimensions, but got array with shape (0, 1)
